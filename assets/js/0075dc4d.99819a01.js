"use strict";(self.webpackChunksiglens_docs=self.webpackChunksiglens_docs||[]).push([[2039],{3442:(n,e,l)=>{l.r(e),l.d(e,{assets:()=>r,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var s=l(5893),t=l(1151);const i={},a="Elasticsearch",o={id:"log-ingestion/fluentd/fluentd-elasticsearch",title:"Elasticsearch",description:"- Siglens can be ingested data in Elasticsearch format using fluentd. Install fluentd. Read more about installation here.",source:"@site/docs/log-ingestion/fluentd/fluentd-elasticsearch.md",sourceDirName:"log-ingestion/fluentd",slug:"/log-ingestion/fluentd/fluentd-elasticsearch",permalink:"/siglens-docs/log-ingestion/fluentd/fluentd-elasticsearch",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Fluentd",permalink:"/siglens-docs/category/fluentd"},next:{title:"Splunk",permalink:"/siglens-docs/log-ingestion/fluentd/fluentd-splunk"}},r={},d=[{value:"Install Fluentd",id:"install-fluentd",level:2},{value:"Setup for Elasticsearch version 7.9.3",id:"setup-for-elasticsearch-version-793",level:3},{value:"Fluentd Configuration",id:"fluentd-configuration",level:2},{value:"Sample Configuration",id:"sample-configuration",level:2},{value:"Run Fluentd Config",id:"run-fluentd-config",level:2},{value:"Linux based systems",id:"linux-based-systems",level:3},{value:"Windows",id:"windows",level:3}];function c(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h1,{id:"elasticsearch",children:"Elasticsearch"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["Siglens can be ingested data in Elasticsearch format using fluentd. Install fluentd. Read more about installation ",(0,s.jsx)(e.a,{href:"#install-fluentd",children:"here"}),"."]}),"\n",(0,s.jsxs)(e.li,{children:["Make sure that the ",(0,s.jsx)(e.code,{children:"host"})," in the configuration has the ",(0,s.jsx)(e.code,{children:"/elastic"})," suffix."]}),"\n",(0,s.jsxs)(e.li,{children:["Create a fluentd config file with the below ",(0,s.jsx)(e.a,{href:"#sample-configuration",children:"sample configuration"}),". Read more about ",(0,s.jsx)(e.a,{href:"#fluentd-configuration",children:"Fluentd Config file"})," below."]}),"\n",(0,s.jsxs)(e.li,{children:["Run the command: ",(0,s.jsx)(e.code,{children:"fluentd -c logstah_config.conf"}),". Read more about ",(0,s.jsx)(e.a,{href:"#run-fluentd-config",children:"running fluentd config"})," below."]}),"\n",(0,s.jsxs)(e.li,{children:["Read more about Fluentd from the ",(0,s.jsx)(e.a,{href:"https://docs.fluentd.org/",children:"official docs here"}),"."]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"install-fluentd",children:"Install Fluentd"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["Install the Fluent-package from the ",(0,s.jsx)(e.a,{href:"https://docs.fluentd.org/installation",children:"official docs"}),".","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["For Debian/Ubuntu: ",(0,s.jsx)(e.a,{href:"https://docs.fluentd.org/installation/install-by-deb#installing-fluent-package",children:"https://docs.fluentd.org/installation/install-by-deb#installing-fluent-package"})]}),"\n",(0,s.jsxs)(e.li,{children:["For macOS: ",(0,s.jsx)(e.a,{href:"https://docs.fluentd.org/installation/obsolete-installation/treasure-agent-v4-installation/install-by-dmg-td-agent-v4",children:"https://docs.fluentd.org/installation/obsolete-installation/treasure-agent-v4-installation/install-by-dmg-td-agent-v4"})]}),"\n",(0,s.jsxs)(e.li,{children:["For Windows: ",(0,s.jsx)(e.a,{href:"https://docs.fluentd.org/installation/install-by-msi",children:"https://docs.fluentd.org/installation/install-by-msi"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.li,{children:"Follow the installation steps from the docs and install fluentd."}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"setup-for-elasticsearch-version-793",children:"Setup for Elasticsearch version 7.9.3"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["Fluentd by default comes with various plugins along with a plugin for Elasticsearch called ",(0,s.jsx)(e.code,{children:"fluent-plugin-elasticsearch"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"But the default plugin version is not compatible with Siglens Elasticsearch version."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Uninstall the default Elasticsearch plugin by running the below command. But before running make sure you are either fluentd-command-promt (on windows) or the path variables setup or in the fluentd directory."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"fluent-gem uninstall fluent-plugin-elasticsearch\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["Then install the ",(0,s.jsx)(e.code,{children:"fluent-plugin-elasticsearch"})," version ",(0,s.jsx)(e.code,{children:"4.3.3"})," by running the below command."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"fluent-gem install fluent-plugin-elasticsearch -v 4.3.3\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["If you're using a ",(0,s.jsx)(e.code,{children:" td-agent"}),", it's recommended to use ",(0,s.jsx)(e.code,{children:"td-agent-gem"})," instead"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"td-agent-gem uninstall fluent-plugin-elasticsearch\n\nsudo td-agent-gem install fluent-plugin-elasticsearch -v 4.3.3\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Check that the correct version of gem is installed by running the below command"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"fluent-gem list | grep fluent-plugin-elasticsearch\n\n# OR\n\ntd-agent-gem list | grep fluent-plugin-elasticsearch\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Might need to setup or install ruby modules or development toolkit. If required it is automatically prompted and installed."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"fluentd-configuration",children:"Fluentd Configuration"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["Fluentd has various input or source plugins. The below sample configuration uses plugin type called ",(0,s.jsx)(e.code,{children:"tail"}),". Read more about ",(0,s.jsx)(e.a,{href:"https://docs.fluentd.org/input",children:"input Plugins here"}),"."]}),"\n",(0,s.jsx)(e.li,{children:"The tag in source is used to to categorize the incoming data. It is is applied to all events coming from the tailed file. This tag can be used to match these events."}),"\n",(0,s.jsx)(e.li,{children:"Fluentd has filter plugins that can be used to mutate the input data from the sources."}),"\n",(0,s.jsxs)(e.li,{children:["The ",(0,s.jsx)(e.code,{children:"<match my.logs>"})," section tells Fluentd that any events tagged with my.logs should be processed by this output plugin configuration."]}),"\n",(0,s.jsxs)(e.li,{children:["The output plugin is set to ",(0,s.jsx)(e.code,{children:"elasticsearch"})," and the host must be ",(0,s.jsx)(e.code,{children:"http://localhost:8081/elastic"})," for the ingestion in elasticsearch format for Siglens."]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"sample-configuration",children:"Sample Configuration"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-conf",children:"<source>\n  @type tail\n  path D:\\Siglens\\SplunkExport.json\n  pos_file D:\\Siglens\\fluentd_logs\\SplunkExport1.log.pos\n  tag my.logs\n  read_from_head true\n  <parse>\n    @type json\n  </parse>\n</source>\n\n<match my.logs>\n  @type elasticsearch\n  host http://localhost:8081/elastic\n  logstash_format true\n  include_tag_key true\n  tag_key @log_name\n  verify_es_version_at_startup false\n  default_elasticsearch_version 7.9\n  request_timeout 45s # defaults to 5s\n</match>\n"})}),"\n",(0,s.jsx)(e.h2,{id:"run-fluentd-config",children:"Run Fluentd Config"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Navigate to the Fluentd installed directory, if fluentd environment is not setup."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["Windows can open the fluentd command prompt and open it as an ",(0,s.jsx)(e.strong,{children:"Administrator"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["Run the command: ",(0,s.jsx)(e.code,{children:"fluentd -c <<path-of-fluentd-config>>"})]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.h3,{id:"linux-based-systems",children:"Linux based systems"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"sudo fluentd -c /home/fluentd_config.conf\n\n# OR\n\nsudo td-agent -c /home/fluentd_config.conf # if td-agent is installed\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.h3,{id:"windows",children:"Windows"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["Open the fluentd command prompt as an ",(0,s.jsx)(e.strong,{children:"Administrator"}),"."]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"fluentd -c /home/fluentd_config.conf\n"})}),"\n"]}),"\n"]})]})}function u(n={}){const{wrapper:e}={...(0,t.a)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(c,{...n})}):c(n)}},1151:(n,e,l)=>{l.d(e,{Z:()=>o,a:()=>a});var s=l(7294);const t={},i=s.createContext(t);function a(n){const e=s.useContext(i);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),s.createElement(i.Provider,{value:e},n.children)}}}]);