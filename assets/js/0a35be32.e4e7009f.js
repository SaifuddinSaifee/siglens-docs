"use strict";(self.webpackChunksiglens_docs=self.webpackChunksiglens_docs||[]).push([[9422],{9899:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>o});var n=i(5893),s=i(1151);const a={},r="Metricbeat",l={id:"log-ingestion/beats/metricbeat-elasticsearch",title:"Metricbeat",description:"Metricbeat can be used to ingest logs into Elasticsearch from various servers like Nginx, apache, etc. Read more about metricbeat here.",source:"@site/docs/log-ingestion/beats/metricbeat-elasticsearch.md",sourceDirName:"log-ingestion/beats",slug:"/log-ingestion/beats/metricbeat-elasticsearch",permalink:"/siglens-docs/log-ingestion/beats/metricbeat-elasticsearch",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Filebeat",permalink:"/siglens-docs/log-ingestion/beats/filebeat-elasticsearch"},next:{title:"Logstash",permalink:"/siglens-docs/category/logstash"}},c={},o=[{value:"Install Metricbeat",id:"install-metricbeat",level:2},{value:"Linux based Systems",id:"linux-based-systems",level:3},{value:"Windows",id:"windows",level:3},{value:"Metricbeat Configuartion",id:"metricbeat-configuartion",level:2},{value:"Sample Configuartion",id:"sample-configuartion",level:2},{value:"Run Metricbeat Config",id:"run-metricbeat-config",level:2},{value:"Linux based systems",id:"linux-based-systems-1",level:3},{value:"Windows",id:"windows-1",level:3},{value:"Metricbeat NOTICE",id:"metricbeat-notice",level:2}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"metricbeat",children:"Metricbeat"}),"\n",(0,n.jsxs)(t.p,{children:["Metricbeat can be used to ingest logs into Elasticsearch from various servers like Nginx, apache, etc. Read more about ",(0,n.jsx)(t.a,{href:"https://www.elastic.co/guide/en/beats/metricbeat/7.9/metricbeat-overview.html",children:"metricbeat here"}),"."]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["SigLens can be ingested data in Elasticsearch format through Metricbeat. Install Metricbeat. Learn more about ",(0,n.jsx)(t.a,{href:"#install-metricbeat",children:"installation here"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:["Make sure that the ",(0,n.jsx)(t.code,{children:"endpoints"})," in the configuration has the ",(0,n.jsx)(t.code,{children:"/elastic"})," suffix."]}),"\n",(0,n.jsxs)(t.li,{children:["Create a metricbeat config file with the below ",(0,n.jsx)(t.a,{href:"#sample-configuartion",children:"sample configuration"}),". Read more about ",(0,n.jsx)(t.a,{href:"#metricbeat-configuartion",children:"Metricbeat Config file"})," below."]}),"\n",(0,n.jsxs)(t.li,{children:["Run the command: ",(0,n.jsx)(t.code,{children:"metricbeat -c filebeat_config.yaml"}),". Read more about ",(0,n.jsx)(t.a,{href:"#run-metricbeat-config",children:"running metricbeat config"})," below."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note:"})," For Linux Systems, please read the ",(0,n.jsx)(t.a,{href:"#metricbeat-notice",children:"NOTICE section"})," below before proceeding with installation."]}),"\n",(0,n.jsx)(t.h2,{id:"install-metricbeat",children:"Install Metricbeat"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["Download this exact version of Metricbeat: ",(0,n.jsx)(t.a,{href:"https://www.elastic.co/downloads/past-releases/metricbeat-oss-7-9-3",children:(0,n.jsx)(t.code,{children:"metricbeat-oss-7.9.3"})}),". It is important to download this version, as this is the version that is compatible with Siglens Elasticsearch version: ",(0,n.jsx)(t.code,{children:"7.9.3"}),"."]}),"\n",(0,n.jsx)(t.li,{children:"The Metricbeat has multiple options to choose from for different OS-based systems."}),"\n",(0,n.jsx)(t.li,{children:"Once the Metricbeat version is downloaded. Use the below commands to install on depending on the OS."}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"linux-based-systems",children:"Linux based Systems"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"sudo dpkg -i metricbeat-oss-7.9.3-amd64.deb\n# OR\ntar xzvf metricbeat-oss-7.9.3-linux-x86_64.tar.gz\n"})}),"\n",(0,n.jsx)(t.h3,{id:"windows",children:"Windows"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Download the Zip version."}),"\n",(0,n.jsx)(t.li,{children:"Extract the contents of the zip file into C:\\Program Files."}),"\n",(0,n.jsx)(t.li,{children:"Rename the metricbeat-oss-7.9.3-windows-x86_64 directory to Metricbeat."}),"\n",(0,n.jsxs)(t.li,{children:["Open a PowerShell prompt as an Administrator (right-click the PowerShell icon and select ",(0,n.jsx)(t.strong,{children:"Run As Administrator"}),")."]}),"\n",(0,n.jsx)(t.li,{children:"From the PowerShell prompt, run the following commands to install Metricbeat as a Windows service:"}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"PS > cd 'C:\\Program Files\\Metricbeat'\nPS C:\\Program Files\\Metricbeat> .\\install-service-metricbeat.ps1\n"})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["Read more about the installation process ",(0,n.jsx)(t.a,{href:"https://www.elastic.co/guide/en/beats/metricbeat/7.9/metricbeat-installation-configuration.html",children:"here"})]}),"\n",(0,n.jsx)(t.li,{children:"But Remember to use the version mentioned above."}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"metricbeat-configuartion",children:"Metricbeat Configuartion"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"The input for a Metricbeat is a list of modules of servers from where the Metricbeat will poll and ingest data."}),"\n",(0,n.jsx)(t.li,{children:"The hosts endpoints should be: [http://localhost:8081/elastic/]"}),"\n",(0,n.jsxs)(t.li,{children:["Read different supported modules by Metricbeat ",(0,n.jsx)(t.a,{href:"https://www.elastic.co/guide/en/beats/metricbeat/7.9/metricbeat-modules.html",children:"here"})]}),"\n",(0,n.jsx)(t.li,{children:"The below example shows the setup of collecting Nginx metrics from a Nginx server and ingesting the metrics to Siglens."}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"sample-configuartion",children:"Sample Configuartion"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",children:"metricbeat.modules:\n  - module: nginx\n    metricsets: ['stubstatus']\n    enabled: true\n    # The interval in seconds to poll each endpoint.\n    period: 10s\n\n    # Nginx hosts\n    hosts: ['http://127.0.0.1']\n\n    # Path to server status. Default nginx_status\n    server_status_path: 'nginx_status'\n\noutput.elasticsearch:\n  # Replace with your custom Elasticsearch endpoint\n  hosts: ['http://localhost:8081/elastic/']\n  index: 'filebeat-ind-0' # Custom index name\n\n# Disable template management\nsetup.template.enabled: false\n\n# Disable ilm\nsetup.ilm.enabled: false\n# logging.level: debug\n"})}),"\n",(0,n.jsx)(t.h2,{id:"run-metricbeat-config",children:"Run Metricbeat Config"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.h3,{id:"linux-based-systems-1",children:"Linux based systems"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.code,{children:"sudo metricbeat -e -c <<path-of-metricbeat-config>>"})}),"\n",(0,n.jsx)(t.li,{children:"-e is an optional argument that is used for logging."}),"\n",(0,n.jsx)(t.li,{children:"The example below assumes that your Metricbeat config file is at /home/metricbeat-config/metricbeat.yaml"}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"sudo metricbeat -e -c /home/metricbeat-config/metricbeat.yaml\n"})}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.h3,{id:"windows-1",children:"Windows"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Navigate to the Path where Metricbeat is."}),"\n",(0,n.jsxs)(t.li,{children:["As per the above setup, it is at ",(0,n.jsx)(t.code,{children:"C:\\Program Files\\Metricbeat"})]}),"\n",(0,n.jsxs)(t.li,{children:["Then run command: ",(0,n.jsx)(t.code,{children:".\\metricbeat.exe -e -c <<path-of-metricbeat-config>>"})]}),"\n",(0,n.jsx)(t.li,{children:"-e is an optional argument that is used for logging."}),"\n",(0,n.jsx)(t.li,{children:"The example below assumes that your Metricbeat config file is at D:\\Siglens\\filebeat_elasticsearch.yml"}),"\n",(0,n.jsxs)(t.li,{children:["Note: Open a PowerShell prompt as an Administrator (right-click the PowerShell icon and select ",(0,n.jsx)(t.strong,{children:"Run As Administrator"}),")."]}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"PS > cd 'C:\\Program Files\\Metricbeat'\nPS C:\\Program Files\\Metricbeat>.\\metricbeat.exe -e -c D:\\Siglens\\filebeat_elasticsearch.yml\n"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"metricbeat-notice",children:"Metricbeat NOTICE"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"The Metricbeat will not work on Linux-based systems because of the go version that is being used in that specific Metricbeat version, which the Linux OS is not allowing the creation of a new thread."}),"\n",(0,n.jsxs)(t.li,{children:["The image shows the error. The related issue of this can be found here: ",(0,n.jsx)(t.a,{href:"https://github.com/docker-library/golang/issues/467",children:"https://github.com/docker-library/golang/issues/467"})]}),"\n"]})]})}function d(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},1151:(e,t,i)=>{i.d(t,{Z:()=>l,a:()=>r});var n=i(7294);const s={},a=n.createContext(s);function r(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);